<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Map Runner</title>
  <style>
      body {
          margin: 0;
          box-sizing: border-box;
          color: white;
          font-family: Arial;
          overflow: hidden;
      }

      #canvas {
        background: #111115;
      }

      #canvas:focus {
        outline: none;
      }

      #game {
        position: relative;
        width: max-content;
        height: max-content;
      }

      ul {
        list-style: none;
      }

      .block {
        display: block;
      }
  </style>
</head>
<body>
  <div id="game">
      <canvas id="canvas" tabindex=1>You browser is too old to use canvas technologies.</canvas>
  </div>
  
  <button id="test">Test</button>
  
  
  <script type="text/javascript" >
    function onProgress(event) {
        if (event.lengthComputable) {
            var percentComplete = (event.loaded / event.total)*100;
            console.log("Téléchargement: %d%%", percentComplete);
        } else {
            // Impossible de calculer la progression puisque la taille totale est inconnue
        }
    }

    function onError(event) {
        console.error("Une erreur " + event.target.status + " s'est produite au cours de la réception du document.");
    }

    function onLoad(event) {
        // Ici, this.readyState égale XMLHttpRequest.DONE .
        if (this.status === 200) {
            console.log("Réponse reçue: %s", this.responseText);
        } else {
            console.log("Status de la réponse: %d (%s)", this.status, this.statusText);
        }
    }

    function onLoadEnd(event) {
        // Cet événement est exécuté, une fois la requête terminée.
        console.log("Le transfert est terminé. (peut importe le résultat)");
    }


    var btn = document.getElementById('test')
    
    btn.addEventListener('click', function(e) {
      e.preventDefault()
    
      const req = new XMLHttpRequest();
      req.onprogress = onProgress;
      req.onerror = onError;
      req.onload = onLoad;
      req.onloadend = onLoadEnd;
      req.open('POST', '/callMap', true);
      req.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');
      req.send('map index lel !');
    })
  </script>

<!-- <script type="text/javascript" src="./canvas.bundle.js"></script> -->
<script type="text/javascript" src="./mapRunner.js"></script>
  </body>
</html>